import { EventEmitter } from './common/Event';
import { execute } from './common/execute';
export class FallbackPolicy {
    constructor(options, value) {
        this.options = options;
        this.value = value;
        this.fallbackEmitter = new EventEmitter();
        /**
         * Event that fires when a fallback happens.
         */
        // tslint:disable-next-line: member-ordering
        this.onFallback = this.fallbackEmitter.addListener;
    }
    /**
     * Executes the given function.
     * @param fn -- Function to execute.
     * @returns The function result or fallback value.
     */
    async execute(fn) {
        const result = await execute(this.options, fn);
        if ('success' in result) {
            return result.success;
        }
        this.fallbackEmitter.emit(result);
        return this.value();
    }
}
//# sourceMappingURL=FallbackPolicy.js.map